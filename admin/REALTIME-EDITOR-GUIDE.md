# ⚡ 实时编辑器使用指南

## 🎯 核心功能

这是一个**真正能够直接修改网站源文件**的可视化编辑器！

### ✨ 主要特点
- **直接修改源文件** - 点击确定后立即修改HTML文件
- **实时生效** - 其他用户访问网站时看到最新内容
- **自动备份** - 每次修改前自动创建备份文件
- **可视化编辑** - 直接在网站页面上点击编辑
- **安全可靠** - 支持撤销和历史记录

## 🚀 快速开始

### 第一步：启动服务器
1. **双击运行** `admin/start-server.bat`
2. **等待启动** 看到"服务器已启动"消息
3. **保持运行** 不要关闭命令行窗口

### 第二步：开始编辑
1. 访问 `/admin/` 管理中心
2. 点击 **"实时编辑器"** 卡片
3. 页面顶部出现编辑工具栏
4. 点击 **"开始编辑"** 按钮

### 第三步：编辑内容
1. **点击任何文字** - 弹出编辑框
2. **修改内容** - 在编辑框中输入新内容
3. **点击"保存到文件"** - 直接修改源文件
4. **确认刷新** - 刷新页面查看最新效果

## 🛠️ 工具栏功能

### 服务器状态
- 🟢 **绿点闪烁** - 服务器在线
- 🔴 **红点** - 服务器离线

### 主要按钮
- **✏️ 开始编辑** - 进入/退出编辑模式
- **💾 保存到文件** - 批量保存所有更改到文件
- **↶ 撤销** - 撤销上一次更改
- **📋 备份** - 查看自动创建的备份文件
- **🔄 刷新** - 刷新页面查看最新效果
- **✖️ 关闭** - 关闭编辑器

## 📝 编辑操作

### 支持编辑的内容
- ✅ 网站标题和副标题
- ✅ 轮播图文字
- ✅ 关于我们内容
- ✅ 服务项目标题和描述
- ✅ 新闻标题和内容
- ✅ 联系信息
- ✅ 导航菜单文字
- ✅ 按钮文字

### 编辑流程
1. **进入编辑模式** - 可编辑元素显示蓝色虚线框
2. **点击文字** - 弹出编辑框
3. **修改内容** - 输入新的文字内容
4. **保存到文件** - 点击"保存到文件"按钮
5. **立即生效** - 文件被直接修改，其他用户立即看到新内容

### 编辑提示
- 🟦 **蓝色虚线** - 鼠标悬停显示可编辑区域
- 🟩 **绿色实线** - 正在编辑的元素
- 📝 **编辑框** - 弹出的内容编辑器
- ⏳ **保存中** - 正在保存到文件的状态

## 💾 文件管理

### 自动备份
- 每次修改前自动创建备份
- 备份文件保存在 `admin/backups/` 目录
- 文件名格式：`index.html.时间戳.bak`
- 点击"备份"按钮查看备份列表

### 文件安全
- 修改前验证文件路径安全性
- 只能修改网站根目录内的文件
- 自动创建备份防止数据丢失
- 支持撤销操作恢复内容

## ⌨️ 快捷键

### 全局快捷键
- `Ctrl + S` - 保存当前编辑或批量保存
- `Ctrl + Z` - 撤销上一次更改
- `Ctrl + E` - 切换编辑模式
- `ESC` - 取消当前编辑

### 编辑模式
- `点击` - 开始编辑元素
- `回车` - 保存当前编辑
- `ESC` - 取消当前编辑

## 🔧 技术要求

### 服务器环境
- **Node.js** 14.0+ (必需)
- **端口** 3001 (默认)
- **权限** 文件读写权限

### 浏览器支持
- ✅ Chrome 60+
- ✅ Firefox 55+
- ✅ Safari 12+
- ✅ Edge 79+

## 📋 API接口

### 主要接口
- `GET /api/health` - 健康检查
- `POST /api/update-element` - 更新单个元素
- `POST /api/batch-update` - 批量更新
- `GET /api/backups` - 获取备份列表

### 请求示例
```javascript
// 更新单个元素
fetch('/api/update-element', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        filename: 'index.html',
        selector: 'h1',
        newContent: '新标题',
        oldContent: '原标题'
    })
});
```

## 🔍 故障排除

### 常见问题

**Q: 服务器无法启动？**
A: 
1. 检查是否安装了Node.js
2. 确保端口3001未被占用
3. 检查文件权限

**Q: 编辑后没有生效？**
A: 
1. 确保服务器状态为在线（绿点）
2. 检查是否点击了"保存到文件"
3. 刷新页面查看最新内容

**Q: 无法编辑某些内容？**
A: 
1. 检查元素是否在支持列表中
2. 确保元素包含文字内容
3. 某些动态内容可能不支持

**Q: 备份文件在哪里？**
A: 
- 位置：`admin/backups/` 目录
- 格式：`文件名.时间戳.bak`
- 查看：点击工具栏"备份"按钮

### 错误处理
- 修改失败时自动显示错误信息
- 网络错误时提示重试
- 文件权限问题时给出解决方案

## 💡 最佳实践

### 使用建议
1. **先备份** - 重要修改前手动备份
2. **小步快跑** - 频繁保存避免丢失
3. **测试验证** - 修改后及时验证效果
4. **保持服务器运行** - 编辑期间不要关闭服务器

### 工作流程
1. 启动编辑服务器
2. 进入编辑模式
3. 逐个编辑需要修改的内容
4. 点击"保存到文件"确认修改
5. 刷新页面验证效果
6. 完成后可关闭服务器

## 🆘 获取帮助

如果遇到问题：
1. 检查服务器是否正常运行
2. 查看浏览器控制台错误信息
3. 确认网络连接正常
4. 参考本文档的故障排除部分

---

**重要提示**：这个编辑器直接修改网站源文件，请在使用前做好备份！
